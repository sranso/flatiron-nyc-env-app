<h1>Filter Results</h1>
<form action="/filter" method="POST">

  <h3>Data Set</h3>
  <% @datasets.each do |dataset| %>
    <label for="data-set"><%= dataset %></label>
    <input type="checkbox" class="data-set-class" name="datasets[<%= dataset %>]">
  <% end %>

  <button type="submit" value="Filter">Filter Results</button>
</form>

<div id="map-canvas"></div>

<script type="text/javascript">
  //initialize map
  var map;
  function initialize() {
    var mapOptions = {
      zoom: 10,
      center: new google.maps.LatLng(40.6700, -73.9400)
    };

    // create that map
    map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
  }

  // load the map
  google.maps.event.addDomListener(window, 'load', initialize);



  // click event, when a checkbox is clicked
  $('.data-set-class').click(function() {
    var $this = $(this);

    // get JSON file name
    var dataName = $this.prev("label").text();
    var fileName = "data/" + dataName.replace(/ /g, "-") + ".json";

    // load the dataset
    $.getJSON(fileName, function(response) {
      // debugger
      // the following works for nyc-cool-roofs
      for (var i = 0; i < response.data.length; i++) {
        var newLatLon = new google.maps.LatLng(response.data[i][13][1], response.data[i][13][2])
        var newMarker = new google.maps.Marker({
          position: newLatLon,
          map: map,
          neighborhood: response.data[i][8],
          street: response.data[i][10],
          street2: response.data[i][11],
          zip: response.data[i][12]
        });
      };
    });
  });

</script>
